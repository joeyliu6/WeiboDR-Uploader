# ç›®å½•ç»“æ„å¯¼è§ˆ

## å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬èŠ‚å­¦ä¹ ï¼Œä½ å°†èƒ½å¤Ÿï¼š
- âœ… ç†è§£é¡¹ç›®çš„æ•´ä½“ç›®å½•ç»„ç»‡
- âœ… å¿«é€Ÿå®šä½åˆ°ç‰¹å®šåŠŸèƒ½çš„ä»£ç æ–‡ä»¶
- âœ… äº†è§£å‰ç«¯å’Œåç«¯çš„æ–‡ä»¶ç»“æ„
- âœ… æŒæ¡å…³é”®é…ç½®æ–‡ä»¶çš„ä½œç”¨
- âœ… ä¸ºåç»­æ·±å…¥å­¦ä¹ æ‰“ä¸‹åŸºç¡€

## å‰ç½®çŸ¥è¯†

- äº†è§£åŸºæœ¬çš„æ–‡ä»¶ç³»ç»Ÿæ¦‚å¿µ
- ç†Ÿæ‚‰ TypeScript å’Œ Rust çš„åŸºæœ¬è¯­æ³•
- å·²å®Œæˆé¡¹ç›®çš„ç¬¬ä¸€æ¬¡è¿è¡Œ

---

## é¡¹ç›®æ•´ä½“ç»“æ„

```
WeiboDR-Uploader/
â”‚
â”œâ”€â”€ src/                           # ğŸ¨ å‰ç«¯æºç ï¼ˆVue 3 + TypeScriptï¼‰
â”‚   â”œâ”€â”€ uploaders/                 # å›¾åºŠä¸Šä¼ å™¨ï¼ˆæ’ä»¶åŒ–è®¾è®¡ï¼‰
â”‚   â”œâ”€â”€ core/                      # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ config/                    # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ components/                # Vue ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                        # UI æ¨¡å—
â”‚   â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ main.ts                    # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ ...                        # å…¶ä»–æ¨¡å—
â”‚
â”œâ”€â”€ src-tauri/                     # ğŸ¦€ Rust åç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ commands/              # Tauri å‘½ä»¤å®ç°
â”‚   â”‚   â””â”€â”€ main.rs                # Rust ä¸»æ–‡ä»¶
â”‚   â”œâ”€â”€ Cargo.toml                 # Rust ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ tauri.conf.json            # Tauri åº”ç”¨é…ç½®
â”‚   â””â”€â”€ icons/                     # åº”ç”¨å›¾æ ‡
â”‚
â”œâ”€â”€ docs/                          # ğŸ“š æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ tutorial/                  # æ•™ç¨‹æ–‡æ¡£ï¼ˆä½ æ­£åœ¨é˜…è¯»çš„ï¼‰
â”‚   â”œâ”€â”€ guides/                    # ç”¨æˆ·æŒ‡å—
â”‚   â””â”€â”€ archive/                   # å†å²æ–‡æ¡£
â”‚
â”œâ”€â”€ index.html                     # ä¸»çª—å£ HTML
â”œâ”€â”€ package.json                   # Node.js ä¾èµ–å’Œè„šæœ¬
â”œâ”€â”€ vite.config.ts                 # Vite æ„å»ºé…ç½®
â”œâ”€â”€ tsconfig.json                  # TypeScript é…ç½®
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
```

---

## å‰ç«¯æºç ç›®å½• (`src/`)

### ğŸ“‚ `src/uploaders/` - å›¾åºŠä¸Šä¼ å™¨ï¼ˆæ ¸å¿ƒï¼ï¼‰

è¿™æ˜¯æ•´ä¸ªé¡¹ç›®æœ€é‡è¦çš„ç›®å½•ï¼Œé‡‡ç”¨**æ’ä»¶åŒ–æ¶æ„**è®¾è®¡ã€‚

```
src/uploaders/
â”œâ”€â”€ base/                          # ğŸ›ï¸ åŸºç¡€æŠ½è±¡å±‚
â”‚   â”œâ”€â”€ IUploader.ts               # æ ¸å¿ƒæ¥å£ï¼ˆ108 è¡Œï¼‰
â”‚   â”œâ”€â”€ BaseUploader.ts            # æŠ½è±¡åŸºç±»ï¼ˆ183 è¡Œï¼‰
â”‚   â”œâ”€â”€ UploaderFactory.ts         # å·¥å‚æ¨¡å¼ç®¡ç†
â”‚   â”œâ”€â”€ types.ts                   # å…±äº«ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts                   # ç»Ÿä¸€å¯¼å‡º
â”‚
â”œâ”€â”€ weibo/                         # å¾®åšå›¾åºŠ
â”‚   â”œâ”€â”€ WeiboUploader.ts           # å¾®åšä¸Šä¼ å™¨å®ç°
â”‚   â”œâ”€â”€ WeiboError.ts              # å¾®åšé”™è¯¯ç±»å‹
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ r2/                            # Cloudflare R2
â”‚   â”œâ”€â”€ R2Uploader.ts              # R2 ä¸Šä¼ å™¨å®ç°
â”‚   â”œâ”€â”€ R2Error.ts                 # R2 é”™è¯¯ç±»å‹
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ tcl/                           # TCL å›¾åºŠï¼ˆæœ€ç®€å•ï¼ï¼‰
â”‚   â”œâ”€â”€ TCLUploader.ts             # TCL ä¸Šä¼ å™¨ï¼ˆ95 è¡Œï¼‰
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ jd/                            # äº¬ä¸œå›¾åºŠ
â”‚   â”œâ”€â”€ JDUploader.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ nowcoder/                      # ç‰›å®¢å›¾åºŠ
â”‚   â”œâ”€â”€ NowcoderUploader.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ qiyu/                          # ä¸ƒé±¼å›¾åºŠ
â”‚   â”œâ”€â”€ QiyuUploader.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ zhihu/                         # çŸ¥ä¹å›¾åºŠ
â”‚   â”œâ”€â”€ ZhihuUploader.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ nami/                          # çº³ç±³å›¾åºŠ
â”‚   â”œâ”€â”€ NamiUploader.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ template/                      # ğŸ“ æ¨¡æ¿ï¼ˆç”¨äºå¿«é€Ÿæ·»åŠ æ–°å›¾åºŠï¼‰
â”‚   â””â”€â”€ TemplateUploader.ts
â”‚
â””â”€â”€ index.ts                       # ç»Ÿä¸€æ³¨å†Œæ‰€æœ‰ä¸Šä¼ å™¨
```

**å…³é”®æ–‡ä»¶è¯´æ˜**ï¼š

| æ–‡ä»¶ | è¡Œæ•° | ä½œç”¨ | é‡è¦ç¨‹åº¦ |
|------|------|------|----------|
| `base/IUploader.ts` | 108 | å®šä¹‰ä¸Šä¼ å™¨æ¥å£è§„èŒƒ | â­â­â­â­â­ |
| `base/BaseUploader.ts` | 183 | æŠ½è±¡åŸºç±»ï¼Œæä¾›é€šç”¨é€»è¾‘ | â­â­â­â­â­ |
| `base/UploaderFactory.ts` | - | å·¥å‚æ¨¡å¼ï¼Œåˆ›å»ºä¸Šä¼ å™¨å®ä¾‹ | â­â­â­â­ |
| `tcl/TCLUploader.ts` | 95 | æœ€ç®€å•çš„ä¸Šä¼ å™¨å®ç° | â­â­â­â­ |
| `weibo/WeiboUploader.ts` | - | å¤æ‚ä¸Šä¼ å™¨ç¤ºä¾‹ | â­â­â­ |
| `template/TemplateUploader.ts` | - | æ–°å›¾åºŠå¼€å‘æ¨¡æ¿ | â­â­â­ |

**å­¦ä¹ è·¯å¾„æ¨è**ï¼š
1. å…ˆå­¦ä¹  `IUploader.ts`ï¼ˆç†è§£æ¥å£è®¾è®¡ï¼‰
2. å†å­¦ä¹  `BaseUploader.ts`ï¼ˆç†è§£ä»£ç å¤ç”¨ï¼‰
3. ç„¶åçœ‹ `TCLUploader.ts`ï¼ˆæœ€ç®€å•çš„å®ç°ï¼‰
4. æœ€åçœ‹ `WeiboUploader.ts`ï¼ˆå¤æ‚åœºæ™¯å¤„ç†ï¼‰

---

### ğŸ“‚ `src/core/` - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

```
src/core/
â”œâ”€â”€ MultiServiceUploader.ts        # å¤šå›¾åºŠç¼–æ’å™¨ï¼ˆ314 è¡Œï¼‰â­â­â­â­â­
â”œâ”€â”€ UploadOrchestrator.ts          # ä¸Šä¼ æµç¨‹ç¼–æ’
â”œâ”€â”€ LinkGenerator.ts               # URL é“¾æ¥ç”Ÿæˆå™¨
â””â”€â”€ index.ts                       # ç»Ÿä¸€å¯¼å‡º
```

**æ ¸å¿ƒæ–‡ä»¶**ï¼š`MultiServiceUploader.ts`

**ä½œç”¨**ï¼š
- ç®¡ç†å¤šä¸ªå›¾åºŠçš„å¹¶è¡Œä¸Šä¼ 
- é™åˆ¶å¹¶å‘æ•°é‡ï¼ˆæœ€å¤š 3 ä¸ªï¼‰
- ç¡®å®šä¸»åŠ›å›¾åºŠå’Œå¤‡ä»½å›¾åºŠ
- å¤„ç†ä¸Šä¼ å¤±è´¥çš„é™çº§ç­–ç•¥

**ä¸ºä»€ä¹ˆé‡è¦**ï¼Ÿ
- è¿™æ˜¯æ•´ä¸ªåº”ç”¨çš„"å¤§è„‘"
- åè°ƒæ‰€æœ‰ä¸Šä¼ å™¨çš„å·¥ä½œ
- å®ç°äº†å¹¶è¡Œä¸Šä¼ çš„æ ¸å¿ƒé€»è¾‘

---

### ğŸ“‚ `src/config/` - é…ç½®ç®¡ç†

```
src/config/
â”œâ”€â”€ types.ts                       # é…ç½®ç±»å‹å®šä¹‰ï¼ˆ437 è¡Œï¼‰â­â­â­â­â­
â””â”€â”€ cookieProviders.ts             # Cookie æä¾›è€…ç®¡ç†
```

**æ ¸å¿ƒæ–‡ä»¶**ï¼š`types.ts`

**å®šä¹‰çš„å…³é”®ç±»å‹**ï¼š
```typescript
// ç”¨æˆ·é…ç½®
interface UserConfig {
  weibo: WeiboConfig;
  r2: R2Config;
  tcl: TCLConfig;
  jd: JDConfig;
  nowcoder: NowcoderConfig;
  // ...
}

// ä¸Šä¼ å†å²è®°å½•
interface HistoryItem {
  id: string;
  fileName: string;
  timestamp: number;
  results: UploadResult[];
  primaryService: string;
}

// æœåŠ¡ç±»å‹ï¼ˆè”åˆç±»å‹ï¼‰
type ServiceType = 'weibo' | 'r2' | 'tcl' | 'jd' | 'nowcoder' | 'qiyu' | 'zhihu' | 'nami';
```

**ä¸ºä»€ä¹ˆé‡è¦**ï¼Ÿ
- æ•´ä¸ªé¡¹ç›®çš„ç±»å‹ç³»ç»ŸåŸºç¡€
- ç¡®ä¿ç±»å‹å®‰å…¨
- é…ç½®è¿ç§»å’ŒéªŒè¯

---

### ğŸ“‚ `src/components/` - Vue ç»„ä»¶

```
src/components/
â”œâ”€â”€ BackupView.vue                 # å¤‡ä»½è§†å›¾ç»„ä»¶
â””â”€â”€ UploadQueue.vue                # ä¸Šä¼ é˜Ÿåˆ—ç»„ä»¶
```

**ä¸ºä»€ä¹ˆç»„ä»¶è¿™ä¹ˆå°‘**ï¼Ÿ
- å¤§éƒ¨åˆ† UI æ˜¯åœ¨ `index.html` ä¸­ç”¨åŸç”Ÿ JavaScript å®ç°çš„
- åªæœ‰å¤æ‚çš„è§†å›¾æ‰ä½¿ç”¨ Vue ç»„ä»¶
- ä¿æŒé¡¹ç›®ç®€æ´

---

### ğŸ“‚ `src/ui/` - UI æ¨¡å—

```
src/ui/
â””â”€â”€ modal.ts                       # æ¨¡æ€æ¡†ç®¡ç†ç³»ç»Ÿ
```

**ä½œç”¨**ï¼š
- ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ¨¡æ€æ¡†ï¼ˆç™»å½•çª—å£ã€R2 ç®¡ç†å™¨ç­‰ï¼‰
- æä¾›æ‰“å¼€/å…³é—­/åˆ‡æ¢ API
- é˜²æ­¢å¤šä¸ªæ¨¡æ€æ¡†åŒæ—¶æ‰“å¼€

---

### ğŸ“‚ `src/utils/` - å·¥å…·å‡½æ•°

```
src/utils/
â””â”€â”€ webdav.ts                      # WebDAV åŒæ­¥å·¥å…·
```

---

### ğŸ“„ æ ¸å¿ƒæ–‡ä»¶

```
src/
â”œâ”€â”€ main.ts                        # åº”ç”¨å…¥å£ï¼ˆâ­â­â­â­â­ï¼‰
â”œâ”€â”€ uploadQueue.ts                 # ä¸Šä¼ é˜Ÿåˆ—ç®¡ç†
â”œâ”€â”€ store.ts                       # æœ¬åœ°å­˜å‚¨å°è£…
â”œâ”€â”€ crypto.ts                      # AES-GCM åŠ å¯†
â”œâ”€â”€ r2-manager.ts                  # R2 æ–‡ä»¶ç®¡ç†å™¨
â”œâ”€â”€ login-webview.ts               # ç™»å½•çª—å£é€»è¾‘
â”œâ”€â”€ config.ts                      # é…ç½®åŠ è½½/ä¿å­˜
â”œâ”€â”€ errors.ts                      # é”™è¯¯ç±»å‹å®šä¹‰
â””â”€â”€ style.css                      # å…¨å±€æ ·å¼
```

**main.tsï¼ˆåº”ç”¨å…¥å£ï¼‰**çš„ä½œç”¨ï¼š
```typescript
// main.ts åšäº†è¿™äº›äº‹æƒ…ï¼š
1. åˆå§‹åŒ–æ‰€æœ‰ä¸Šä¼ å™¨ï¼ˆæ³¨å†Œåˆ° UploaderFactoryï¼‰
2. åˆ›å»º MultiServiceUploader å®ä¾‹
3. åŠ è½½ç”¨æˆ·é…ç½®
4. åˆå§‹åŒ–ä¸Šä¼ é˜Ÿåˆ—
5. ç»‘å®š UI äº‹ä»¶ç›‘å¬å™¨
6. æŒ‚è½½ Vue ç»„ä»¶
```

**ä¸ºä»€ä¹ˆ main.ts é‡è¦**ï¼Ÿ
- å®ƒæ˜¯æ•´ä¸ªåº”ç”¨çš„èµ·ç‚¹
- ä¸²è”æ‰€æœ‰æ¨¡å—
- åˆå§‹åŒ–æ ¸å¿ƒå¯¹è±¡

---

## Rust åç«¯ç›®å½• (`src-tauri/`)

### ğŸ“‚ `src-tauri/src/commands/` - Rust å‘½ä»¤å®ç°

```
src-tauri/src/commands/
â”œâ”€â”€ mod.rs                         # æ¨¡å—å®šä¹‰
â”œâ”€â”€ tcl.rs                         # TCL ä¸Šä¼ å‘½ä»¤
â”œâ”€â”€ jd.rs                          # äº¬ä¸œä¸Šä¼ å‘½ä»¤
â”œâ”€â”€ nowcoder.rs                    # ç‰›å®¢ä¸Šä¼ å‘½ä»¤
â”œâ”€â”€ r2.rs                          # R2 ä¸Šä¼ å‘½ä»¤
â”œâ”€â”€ qiyu.rs                        # ä¸ƒé±¼ä¸Šä¼ å‘½ä»¤
â”œâ”€â”€ qiyu_token.rs                  # ä¸ƒé±¼ Token è·å–
â”œâ”€â”€ zhihu.rs                       # çŸ¥ä¹ä¸Šä¼ å‘½ä»¤
â”œâ”€â”€ nami.rs                        # çº³ç±³ä¸Šä¼ å‘½ä»¤
â”œâ”€â”€ nami_token.rs                  # çº³ç±³ Token è·å–
â”œâ”€â”€ upload.rs                      # é€šç”¨ä¸Šä¼ é€»è¾‘
â””â”€â”€ utils.rs                       # å·¥å…·å‡½æ•°
```

**æ¯ä¸ªå‘½ä»¤æ–‡ä»¶çš„ç»“æ„**ï¼ˆä»¥ `tcl.rs` ä¸ºä¾‹ï¼‰ï¼š
```rust
// 1. å¯¼å…¥ä¾èµ–
use tauri::{command, Window};
use reqwest::multipart::Form;

// 2. å®šä¹‰è¿”å›ç±»å‹
#[derive(serde::Serialize)]
pub struct TclUploadResult {
    pub url: String,
}

// 3. å®ç°ä¸Šä¼ å‘½ä»¤
#[tauri::command]
pub async fn upload_to_tcl(
    id: String,            // ä¸Šä¼  IDï¼ˆç”¨äºè¿›åº¦äº‹ä»¶ï¼‰
    file_path: String,     // æ–‡ä»¶è·¯å¾„
    window: Window,        // Tauri çª—å£ï¼ˆç”¨äºå‘é€è¿›åº¦äº‹ä»¶ï¼‰
) -> Result<TclUploadResult, String> {
    // ä¸Šä¼ å®ç°...
}
```

---

### ğŸ“„ `src-tauri/src/main.rs` - Rust ä¸»æ–‡ä»¶

**ä½œç”¨**ï¼š
```rust
// main.rs åšäº†è¿™äº›äº‹æƒ…ï¼š
1. åˆå§‹åŒ–å…¨å±€ HTTP å®¢æˆ·ç«¯
2. æ³¨å†Œæ‰€æœ‰ Tauri å‘½ä»¤
3. è®¾ç½®çª—å£èœå•å’Œæ‰˜ç›˜
4. å¯åŠ¨ Tauri åº”ç”¨
```

**å…³é”®ä»£ç ç‰‡æ®µ**ï¼š
```rust
fn main() {
    tauri::Builder::default()
        .invoke_handler(tauri::generate_handler![
            commands::upload_to_tcl,
            commands::upload_to_jd,
            commands::upload_to_nowcoder,
            commands::upload_to_r2,
            // ... å…¶ä»–å‘½ä»¤
        ])
        .run(tauri::generate_context!())
        .expect("error while running tauri application");
}
```

---

### ğŸ“„ `src-tauri/Cargo.toml` - Rust ä¾èµ–é…ç½®

**æ ¸å¿ƒä¾èµ–**ï¼š
```toml
[dependencies]
tauri = "1.5"               # Tauri æ¡†æ¶
reqwest = { version = "0.11", features = ["multipart"] }  # HTTP å®¢æˆ·ç«¯
serde = "1.0"               # åºåˆ—åŒ–/ååºåˆ—åŒ–
serde_json = "1.0"          # JSON å¤„ç†
tokio = "1.35"              # å¼‚æ­¥è¿è¡Œæ—¶
```

---

### ğŸ“„ `src-tauri/tauri.conf.json` - Tauri åº”ç”¨é…ç½®

**å…³é”®é…ç½®**ï¼š
```json
{
  "build": {
    "beforeDevCommand": "npm run dev",      // å¼€å‘æ¨¡å¼å‰ç½®å‘½ä»¤
    "beforeBuildCommand": "npm run build",  // æ„å»ºå‰ç½®å‘½ä»¤
    "devPath": "http://localhost:1420",     // å¼€å‘æœåŠ¡å™¨åœ°å€
    "distDir": "../dist"                    // ç”Ÿäº§æ„å»ºè¾“å‡ºç›®å½•
  },
  "tauri": {
    "allowlist": {
      "all": false,                         // é»˜è®¤ç¦ç”¨æ‰€æœ‰ API
      "shell": { "open": true },            // å…è®¸æ‰“å¼€å¤–éƒ¨é“¾æ¥
      "dialog": { "open": true },           // å…è®¸æ–‡ä»¶å¯¹è¯æ¡†
      "fs": { "readFile": true }            // å…è®¸è¯»å–æ–‡ä»¶
    },
    "windows": [
      {
        "title": "WeiboDR-Uploader",        // çª—å£æ ‡é¢˜
        "width": 1200,                      // çª—å£å®½åº¦
        "height": 800                       // çª—å£é«˜åº¦
      }
    ]
  }
}
```

---

## é…ç½®æ–‡ä»¶

### ğŸ“„ `package.json` - Node.js ä¾èµ–å’Œè„šæœ¬

**æ ¸å¿ƒè„šæœ¬**ï¼š
```json
{
  "scripts": {
    "dev": "vite",                        // å¯åŠ¨ Vite å¼€å‘æœåŠ¡å™¨
    "build": "tsc && vite build",         // TypeScript ç¼–è¯‘ + Vite æ„å»º
    "preview": "vite preview",            // é¢„è§ˆç”Ÿäº§æ„å»º
    "tauri": "tauri"                      // Tauri CLI å‘½ä»¤
  }
}
```

**å¸¸ç”¨å‘½ä»¤**ï¼š
```bash
npm run dev             # åªå¯åŠ¨å‰ç«¯ï¼ˆç”¨äºå¿«é€Ÿè°ƒè¯• UIï¼‰
npm run tauri dev       # å¯åŠ¨å®Œæ•´åº”ç”¨ï¼ˆå‰ç«¯ + åç«¯ï¼‰
npm run build           # æ„å»ºå‰ç«¯
npm run tauri build     # æ„å»ºå®Œæ•´åº”ç”¨ï¼ˆç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰
```

---

### ğŸ“„ `vite.config.ts` - Vite æ„å»ºé…ç½®

**å…³é”®é…ç½®**ï¼š
```typescript
export default defineConfig({
  plugins: [vue()],              // Vue 3 æ’ä»¶
  server: {
    port: 1420,                  // å¼€å‘æœåŠ¡å™¨ç«¯å£
    strictPort: true             // ç«¯å£è¢«å ç”¨æ—¶æŠ¥é”™ï¼ˆè€Œéæ¢ç«¯å£ï¼‰
  },
  build: {
    target: 'esnext',            // ç›®æ ‡ ES ç‰ˆæœ¬
    minify: 'esbuild'            // ä½¿ç”¨ esbuild å‹ç¼©
  }
})
```

---

### ğŸ“„ `tsconfig.json` - TypeScript é…ç½®

**å…³é”®é…ç½®**ï¼š
```json
{
  "compilerOptions": {
    "strict": true,              // ä¸¥æ ¼æ¨¡å¼ï¼ˆå¼ºçƒˆæ¨èï¼ï¼‰
    "target": "ESNext",          // ç¼–è¯‘ç›®æ ‡
    "module": "ESNext",          // æ¨¡å—ç³»ç»Ÿ
    "moduleResolution": "node",  // æ¨¡å—è§£æç­–ç•¥
    "skipLibCheck": true         // è·³è¿‡åº“æ–‡ä»¶ç±»å‹æ£€æŸ¥ï¼ˆåŠ å¿«ç¼–è¯‘ï¼‰
  }
}
```

---

## æ–‡æ¡£ç›®å½• (`docs/`)

```
docs/
â”œâ”€â”€ tutorial/                      # ğŸ“š æ–°æ‰‹æ•™ç¨‹ï¼ˆä½ æ­£åœ¨é˜…è¯»çš„ï¼‰
â”‚   â”œâ”€â”€ README.md                  # æ•™ç¨‹å¯¼èˆª
â”‚   â”œâ”€â”€ 00-prerequisites/          # å‰ç½®çŸ¥è¯†
â”‚   â”œâ”€â”€ 01-getting-started/        # é¡¹ç›®åˆæ¢
â”‚   â”œâ”€â”€ 02-core-concepts/          # æ ¸å¿ƒæ¦‚å¿µ
â”‚   â”œâ”€â”€ 03-frontend-deep-dive/     # å‰ç«¯æ·±å…¥
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ guides/                        # ğŸ“– ç”¨æˆ·æŒ‡å—
â”‚   â”œâ”€â”€ README.md                  # æŒ‡å—ç´¢å¼•
â”‚   â”œâ”€â”€ OFFICIAL_LOGIN_GUIDE.md    # å¾®åš Cookie è·å–
â”‚   â”œâ”€â”€ R2_SETUP_GUIDE.md          # R2 é…ç½®æŒ‡å—
â”‚   â”œâ”€â”€ NOWCODER_SETUP_GUIDE.md    # ç‰›å®¢é…ç½®æŒ‡å—
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ archive/                       # ğŸ—‚ï¸ å†å²æ–‡æ¡£
    â””â”€â”€ ...
```

---

## ç”Ÿæˆç›®å½•ï¼ˆè¿è¡Œæ—¶åˆ›å»ºï¼‰

### ğŸ“‚ `node_modules/` - Node.js ä¾èµ–

**å¤§å°**ï¼šçº¦ 200-300 MB

**å†…å®¹**ï¼š
- Vue 3 æºç 
- TypeScript ç¼–è¯‘å™¨
- Vite æ„å»ºå·¥å…·
- AWS SDK
- å…¶ä»– npm åŒ…

**æ³¨æ„**ï¼š
- å·²åœ¨ `.gitignore` ä¸­å¿½ç•¥
- æ¯æ¬¡ `npm install` é‡æ–°ç”Ÿæˆ

---

### ğŸ“‚ `src-tauri/target/` - Rust ç¼–è¯‘è¾“å‡º

**å¤§å°**ï¼šçº¦ 2-3 GBï¼ˆç¬¬ä¸€æ¬¡ç¼–è¯‘åï¼‰

**ç»“æ„**ï¼š
```
src-tauri/target/
â”œâ”€â”€ debug/                         # å¼€å‘æ¨¡å¼ç¼–è¯‘è¾“å‡º
â”‚   â””â”€â”€ weibodr-uploader.exe       # å¼€å‘ç‰ˆå¯æ‰§è¡Œæ–‡ä»¶
â”‚
â””â”€â”€ release/                       # ç”Ÿäº§æ¨¡å¼ç¼–è¯‘è¾“å‡º
    â”œâ”€â”€ weibodr-uploader.exe       # ç”Ÿäº§ç‰ˆå¯æ‰§è¡Œæ–‡ä»¶
    â””â”€â”€ bundle/                    # æ‰“åŒ…åçš„å®‰è£…ç¨‹åº
        â”œâ”€â”€ msi/                   # Windows å®‰è£…åŒ…
        â”œâ”€â”€ dmg/                   # macOS å®‰è£…åŒ…
        â””â”€â”€ deb/                   # Linux å®‰è£…åŒ…
```

**æ³¨æ„**ï¼š
- å·²åœ¨ `.gitignore` ä¸­å¿½ç•¥
- ç¬¬ä¸€æ¬¡ç¼–è¯‘å¾ˆæ…¢ï¼ˆ2-5 åˆ†é’Ÿï¼‰
- åç»­å¢é‡ç¼–è¯‘å¾ˆå¿«ï¼ˆ10-30 ç§’ï¼‰

---

### ğŸ“‚ `dist/` - å‰ç«¯æ„å»ºè¾“å‡º

**ç”Ÿæˆæ–¹å¼**ï¼š
```bash
npm run build
```

**ç»“æ„**ï¼š
```
dist/
â”œâ”€â”€ index.html                     # å‹ç¼©åçš„ HTML
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ main-a1b2c3.js            # å‹ç¼©åçš„ JSï¼ˆå¸¦ hashï¼‰
â”‚   â””â”€â”€ main-d4e5f6.css           # å‹ç¼©åçš„ CSSï¼ˆå¸¦ hashï¼‰
â””â”€â”€ ...
```

**æ³¨æ„**ï¼š
- Tauri æ‰“åŒ…æ—¶ä¼šä½¿ç”¨ `dist/` çš„å†…å®¹
- å·²åœ¨ `.gitignore` ä¸­å¿½ç•¥

---

## å…³é”®æ–‡ä»¶é€ŸæŸ¥è¡¨

| æ–‡ä»¶è·¯å¾„ | ä½œç”¨ | é‡è¦ç¨‹åº¦ | è¡Œæ•° |
|----------|------|----------|------|
| `src/main.ts` | åº”ç”¨å…¥å£ï¼Œåˆå§‹åŒ–æ‰€æœ‰æ¨¡å— | â­â­â­â­â­ | ~300 |
| `src/uploaders/base/IUploader.ts` | ä¸Šä¼ å™¨æ¥å£å®šä¹‰ | â­â­â­â­â­ | 108 |
| `src/uploaders/base/BaseUploader.ts` | æŠ½è±¡åŸºç±»ï¼Œé€šç”¨é€»è¾‘ | â­â­â­â­â­ | 183 |
| `src/core/MultiServiceUploader.ts` | å¤šå›¾åºŠç¼–æ’å™¨ | â­â­â­â­â­ | 314 |
| `src/config/types.ts` | ç±»å‹ç³»ç»Ÿå®šä¹‰ | â­â­â­â­â­ | 437 |
| `src/uploaders/tcl/TCLUploader.ts` | æœ€ç®€å•çš„ä¸Šä¼ å™¨ | â­â­â­â­ | 95 |
| `src-tauri/src/main.rs` | Rust ä¸»æ–‡ä»¶ | â­â­â­â­ | ~150 |
| `src-tauri/src/commands/tcl.rs` | TCL ä¸Šä¼ å‘½ä»¤ | â­â­â­â­ | ~120 |
| `index.html` | ä¸»çª—å£ HTML | â­â­â­ | ~800 |
| `package.json` | Node.js ä¾èµ–å’Œè„šæœ¬ | â­â­â­ | 28 |
| `src-tauri/tauri.conf.json` | Tauri é…ç½® | â­â­â­ | ~200 |
| `vite.config.ts` | Vite æ„å»ºé…ç½® | â­â­ | ~30 |
| `tsconfig.json` | TypeScript é…ç½® | â­â­ | ~20 |

---

## å¦‚ä½•å¿«é€Ÿå®šä½ä»£ç ï¼Ÿ

### åœºæ™¯ 1ï¼šæˆ‘æƒ³äº†è§£æŸä¸ªå›¾åºŠçš„å®ç°

**è·¯å¾„**ï¼š`src/uploaders/<å›¾åºŠå>/`

ä¾‹å¦‚ï¼š
- TCL å›¾åºŠ â†’ `src/uploaders/tcl/TCLUploader.ts`
- å¾®åšå›¾åºŠ â†’ `src/uploaders/weibo/WeiboUploader.ts`
- R2 å›¾åºŠ â†’ `src/uploaders/r2/R2Uploader.ts`

---

### åœºæ™¯ 2ï¼šæˆ‘æƒ³äº†è§£å¹¶è¡Œä¸Šä¼ çš„é€»è¾‘

**è·¯å¾„**ï¼š`src/core/MultiServiceUploader.ts`

**å…³é”®æ–¹æ³•**ï¼š
- `uploadToMultipleServices()` - å¹¶è¡Œä¸Šä¼ æ ¸å¿ƒé€»è¾‘
- `filterConfiguredServices()` - è¿‡æ»¤å·²é…ç½®çš„å›¾åºŠ

---

### åœºæ™¯ 3ï¼šæˆ‘æƒ³äº†è§£é…ç½®æ˜¯å¦‚ä½•ä¿å­˜çš„

**è·¯å¾„**ï¼š
- `src/store.ts` - æœ¬åœ°å­˜å‚¨å°è£…
- `src/crypto.ts` - AES-GCM åŠ å¯†
- `src/config/types.ts` - é…ç½®ç±»å‹å®šä¹‰

---

### åœºæ™¯ 4ï¼šæˆ‘æƒ³äº†è§£ Rust åç«¯å¦‚ä½•å¤„ç†ä¸Šä¼ 

**è·¯å¾„**ï¼š`src-tauri/src/commands/<å›¾åºŠå>.rs`

ä¾‹å¦‚ï¼š
- TCL ä¸Šä¼  â†’ `src-tauri/src/commands/tcl.rs`
- R2 ä¸Šä¼  â†’ `src-tauri/src/commands/r2.rs`

---

### åœºæ™¯ 5ï¼šæˆ‘æƒ³æ·»åŠ ä¸€ä¸ªæ–°å›¾åºŠ

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
1. `src/uploaders/<æ–°å›¾åºŠ>/NewUploader.ts` - åˆ›å»ºä¸Šä¼ å™¨
2. `src/uploaders/base/UploaderFactory.ts` - æ³¨å†Œåˆ°å·¥å‚
3. `src/config/types.ts` - æ·»åŠ é…ç½®ç±»å‹
4. `src-tauri/src/commands/<æ–°å›¾åºŠ>.rs` - å®ç° Rust å‘½ä»¤
5. `src-tauri/src/main.rs` - æ³¨å†Œ Rust å‘½ä»¤

**æ¨¡æ¿**ï¼š`src/uploaders/template/TemplateUploader.ts`

---

## å®æˆ˜ç»ƒä¹ 

### ç»ƒä¹  1ï¼šæ‰¾åˆ°ä¸Šä¼ è¿›åº¦ç›‘å¬çš„ä»£ç 

**ä»»åŠ¡**ï¼šæ‰¾åˆ° BaseUploader ä¸­ç›‘å¬ä¸Šä¼ è¿›åº¦çš„ä»£ç 

**æç¤º**ï¼š
- æ–‡ä»¶ï¼š`src/uploaders/base/BaseUploader.ts`
- æ–¹æ³•ï¼š`uploadViaRust()`
- å…³é”®è¯ï¼š`listen`ã€`progress`

**ç­”æ¡ˆ**ï¼š[BaseUploader.ts:95-100](../../src/uploaders/base/BaseUploader.ts#L95-L100)

---

### ç»ƒä¹  2ï¼šæ‰¾åˆ°å·¥å‚æ¨¡å¼æ³¨å†Œä¸Šä¼ å™¨çš„ä»£ç 

**ä»»åŠ¡**ï¼šæ‰¾åˆ° UploaderFactory å¦‚ä½•æ³¨å†Œä¸Šä¼ å™¨

**æç¤º**ï¼š
- æ–‡ä»¶ï¼š`src/uploaders/base/UploaderFactory.ts`
- æ–¹æ³•ï¼š`register()`

---

### ç»ƒä¹  3ï¼šæŸ¥çœ‹ TCL çš„ Rust å®ç°

**ä»»åŠ¡**ï¼šæŸ¥çœ‹ TCL ä¸Šä¼ å‘½ä»¤çš„ Rust å®ç°

**æç¤º**ï¼š
- æ–‡ä»¶ï¼š`src-tauri/src/commands/tcl.rs`
- å‡½æ•°ï¼š`upload_to_tcl()`

---

## ç›®å½•ç»„ç»‡è®¾è®¡åŸåˆ™

### 1. æ’ä»¶åŒ–è®¾è®¡

æ¯ä¸ªå›¾åºŠéƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„"æ’ä»¶"ï¼š
```
src/uploaders/
  â”œâ”€â”€ base/          # åŸºç¡€æŠ½è±¡ï¼ˆInterface + BaseClass + Factoryï¼‰
  â”œâ”€â”€ weibo/         # æ’ä»¶ 1
  â”œâ”€â”€ r2/            # æ’ä»¶ 2
  â””â”€â”€ tcl/           # æ’ä»¶ 3
```

**å¥½å¤„**ï¼š
- âœ… æ·»åŠ æ–°å›¾åºŠæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
- âœ… æ¯ä¸ªå›¾åºŠç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•
- âœ… ç¬¦åˆå¼€é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼‰

---

### 2. å‰åç«¯åˆ†ç¦»

```
src/             # å‰ç«¯ï¼ˆTypeScriptï¼‰
src-tauri/       # åç«¯ï¼ˆRustï¼‰
```

**é€šä¿¡æ–¹å¼**ï¼šTauri IPCï¼ˆinvoke è°ƒç”¨å‘½ä»¤ï¼Œlisten ç›‘å¬äº‹ä»¶ï¼‰

**å¥½å¤„**ï¼š
- âœ… å‰åç«¯ç‹¬ç«‹å¼€å‘
- âœ… å‰ç«¯ä¸“æ³¨ UI å’Œä¸šåŠ¡é€»è¾‘
- âœ… åç«¯ä¸“æ³¨æ–‡ä»¶æ“ä½œå’Œç½‘ç»œè¯·æ±‚

---

### 3. é…ç½®é›†ä¸­ç®¡ç†

æ‰€æœ‰é…ç½®ç±»å‹å®šä¹‰åœ¨ï¼š`src/config/types.ts`

**å¥½å¤„**ï¼š
- âœ… ç±»å‹å®‰å…¨
- âœ… é…ç½®è¿ç§»æ–¹ä¾¿
- âœ… ç»Ÿä¸€ç®¡ç†

---

## ä¸‹ä¸€æ­¥å­¦ä¹ 

### å·²å®Œæˆ
- âœ… ç†è§£é¡¹ç›®æ•´ä½“ç»“æ„
- âœ… ç†Ÿæ‚‰å‰ç«¯å’Œåç«¯çš„ç›®å½•ç»„ç»‡
- âœ… æŒæ¡å…³é”®æ–‡ä»¶çš„ä½œç”¨
- âœ… çŸ¥é“å¦‚ä½•å¿«é€Ÿå®šä½ä»£ç 

### æ¥ä¸‹æ¥
1. [**ç¬¬ 2 ç« ï¼šæ ¸å¿ƒæ¦‚å¿µ**](../02-core-concepts/01-plugin-architecture.md)
   - æ·±å…¥ç†è§£æ’ä»¶åŒ–æ¶æ„
   - å­¦ä¹ è®¾è®¡æ¨¡å¼çš„åº”ç”¨
   - ç†è§£ç±»å‹ç³»ç»Ÿè®¾è®¡

2. [**ç¬¬ 3 ç« ï¼šå‰ç«¯æ·±å…¥**](../03-frontend-deep-dive/01-uploader-interface.md)
   - é€è¡Œè®²è§£æ ¸å¿ƒæ–‡ä»¶
   - ç†è§£æ¯ä¸ªå‡½æ•°çš„ä½œç”¨
   - æŒæ¡å®ç°ç»†èŠ‚

---

## æ€»ç»“

é€šè¿‡æœ¬èŠ‚ï¼Œä½ å·²ç»ï¼š

âœ… **æŒæ¡äº†é¡¹ç›®çš„æ•´ä½“ç»“æ„** - çŸ¥é“æ¯ä¸ªç›®å½•çš„ä½œç”¨
âœ… **äº†è§£äº†å…³é”®æ–‡ä»¶çš„ä½ç½®** - å¯ä»¥å¿«é€Ÿå®šä½ä»£ç 
âœ… **ç†è§£äº†ç›®å½•ç»„ç»‡çš„è®¾è®¡åŸåˆ™** - æ’ä»¶åŒ–ã€å‰åç«¯åˆ†ç¦»ã€é…ç½®é›†ä¸­
âœ… **ä¸ºæ·±å…¥å­¦ä¹ æ‰“ä¸‹äº†åŸºç¡€** - çŸ¥é“ä»å“ªé‡Œå¼€å§‹é˜…è¯»ä»£ç 

**ç¬¬ 1 ç« å®Œæˆï¼** ğŸ‰

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ **æ ¸å¿ƒæ¦‚å¿µ**ï¼ŒåŒ…æ‹¬æ’ä»¶åŒ–æ¶æ„ã€è®¾è®¡æ¨¡å¼ã€ç±»å‹ç³»ç»Ÿç­‰ï¼Œå¸®åŠ©ä½ ç†è§£ WeiboDR-Uploader çš„è®¾è®¡æ€æƒ³ï¼
