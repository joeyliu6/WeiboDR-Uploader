# WeiboDR-Uploader 设置 v2.0 用户指南

## 🎉 新功能介绍

### 1. 自动保存功能

现在您不需要再点击"保存"按钮了！

**使用方法：**
- 在设置页面修改任何配置
- 当您点击输入框外部或切换到其他输入框时，设置会自动保存
- 页面底部会显示"✓ 已自动保存"确认消息

**支持的配置项：**
- 微博 Cookie
- R2 备份配置（Account ID、密钥、存储桶等）
- 百度代理前缀
- 输出格式选择
- WebDAV 自动备份配置

---

### 2. R2 连接测试

在保存 R2 配置之前，您可以先测试连接是否正常！

**使用步骤：**

1. 填写 R2 配置信息：
   ```
   R2 账户 ID (Account ID): 您的账户ID
   R2 访问密钥 ID (Access Key ID): 您的访问密钥
   R2 访问密钥 (Secret Access Key): 您的密钥
   R2 存储桶名称 (Bucket Name): 您的存储桶名称
   ```

2. 点击"测试 R2 连接"按钮

3. 查看测试结果：
   - ✅ **成功**：显示绿色"R2 连接成功！"
   - ❌ **失败**：显示红色错误信息，根据提示检查配置

**常见错误及解决方法：**

| 错误信息 | 原因 | 解决方法 |
|---------|------|---------|
| "配置不完整" | 必填字段为空 | 确保填写所有必填项 |
| "存储桶未找到" | Bucket 名称错误 | 检查 Bucket Name 是否正确 |
| "凭据无效或权限不足" | 密钥错误或权限问题 | 检查 Access Key ID 和 Secret Access Key，确保有读取权限 |
| "无法连接到 R2 服务器" | 网络问题 | 检查网络连接 |

---

### 3. WebDAV 连接测试

在设置 WebDAV 自动备份前，测试连接是否正常！

**使用步骤：**

1. 填写 WebDAV 配置信息：
   ```
   WebDAV URL: https://dav.jianguoyun.com/dav/  (以坚果云为例)
   WebDAV 用户名: 您的邮箱地址
   WebDAV 密码: 应用授权码（不是登录密码）
   远程路径: /WeiboDR/history.json
   ```

2. 点击"测试 WebDAV 连接"按钮

3. 查看测试结果：
   - ✅ **成功**：显示绿色"WebDAV 连接成功！"
   - ❌ **失败**：显示红色错误信息，根据提示检查配置

**常见错误及解决方法：**

| 错误信息 | 原因 | 解决方法 |
|---------|------|---------|
| "配置不完整" | 必填字段为空 | 确保填写 URL、用户名和密码 |
| "用户名或密码错误" | 认证失败 | 检查用户名和密码，确认使用的是应用授权码 |
| "URL 未找到" | URL 错误 | 检查 WebDAV URL 是否正确 |
| "无法连接到服务器" | 网络问题 | 检查网络连接和防火墙设置 |

---

## 💡 使用建议

### 坚果云 WebDAV 配置示例

1. **获取应用授权码：**
   - 登录坚果云网页版
   - 进入"账户信息" → "安全选项"
   - 点击"添加应用密码"
   - 记录生成的授权码（类似：`abcd-efgh-ijkl-mnop`）

2. **填写配置：**
   ```
   URL: https://dav.jianguoyun.com/dav/
   用户名: your-email@example.com
   密码: abcd-efgh-ijkl-mnop  (应用授权码)
   ```

3. **测试连接** → **自动保存** → **完成！**

---

### R2 配置获取指南

1. 登录 [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. 进入 R2 页面
3. 获取 Account ID（在右上角）
4. 点击"管理 R2 API 令牌" 创建 API 令牌
5. 记录 Access Key ID 和 Secret Access Key
6. 创建或选择一个 Bucket
7. 在应用中填写配置并测试连接

---

## ⚡ 快捷操作

- **快速测试所有配置：**
  1. 填写微博 Cookie → 点击"测试连接"
  2. 填写 R2 配置 → 点击"测试 R2 连接"
  3. 填写 WebDAV 配置 → 点击"测试 WebDAV 连接"
  4. 所有配置会自动保存，无需额外操作！

- **配置建议顺序：**
  1. 微博 Cookie（必填）
  2. R2 备份（可选）
  3. WebDAV 备份（可选）
  4. 输出格式设置

---

## ❓ 常见问题

**Q: 为什么没有保存按钮了？**  
A: 新版本采用自动保存，您修改任何配置后点击输入框外部即会自动保存，更加方便快捷。

**Q: 如何知道配置已经保存？**  
A: 页面底部会显示"✓ 已自动保存"绿色提示，持续 2 秒后消失。

**Q: 测试连接失败怎么办？**  
A: 根据错误提示检查配置，常见问题包括：
- 密钥或密码输入错误
- 网络连接问题
- 权限设置不正确
- URL 格式错误

**Q: WebDAV 密码是什么？**  
A: WebDAV 密码通常是"应用授权码"，不是您的登录密码。需要在对应服务（如坚果云）的设置中生成。

**Q: R2 测试连接需要多久？**  
A: 通常 1-3 秒。如果超过 10 秒未响应，可能是网络问题。

---

## 🔒 隐私说明

- 所有配置信息都保存在本地
- 测试连接时，数据仅发送到您指定的服务器
- 不会向第三方服务器发送任何敏感信息
- 密码和密钥在内存中安全处理，不会被记录到日志

---

## 📞 需要帮助？

如果您遇到问题：
1. 查看本指南的"常见问题"部分
2. 检查 `SETTINGS_V2_IMPLEMENTATION.md` 了解技术细节
3. 在 GitHub Issues 中提交问题

---

**享受新版本的便利功能吧！** 🚀

